<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Log in — Your Site</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400,700&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Nunito',sans-serif;background:linear-gradient(135deg,#0a1b2a 0%,#112f4a 100%);color:#e0e6f0;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:1.5rem}
    .card{background:rgba(20,45,75,0.95);padding:2rem 2.5rem;border-radius:15px;box-shadow:0 0 25px rgba(255,59,59,0.4),inset 0 0 10px rgba(255,59,59,0.2);width:100%;max-width:420px;text-align:center}
    h1{color:#ff3b3b;font-size:2rem;font-weight:800;text-shadow:0 0 8px #ff3b3b;margin-bottom:.5rem}
    .subtitle{font-size:1rem;color:#d1d9efcc;margin-bottom:1.5rem}
    .form-group{margin-bottom:1.2rem;text-align:right}
    label{display:block;margin-bottom:.4rem;font-weight:700;color:#ffdede}
    input[type="email"],input[type="password"]{width:100%;padding:.6rem .8rem;border-radius:8px;border:none;background:rgba(255,255,255,0.08);color:#fff;font-size:1rem;outline:none;box-shadow:inset 0 0 5px rgba(255,59,59,0.4);transition:box-shadow .3s,background .3s}
    input:focus{background:rgba(255,255,255,0.12);box-shadow:0 0 8px #ff3b3b,inset 0 0 8px #ff3b3b}
    .btn{width:100%;padding:.75rem;font-size:1.05rem;font-weight:800;background:#ff3b3b;color:#fff;border:none;border-radius:8px;cursor:pointer;box-shadow:0 0 15px #ff3b3baa;transition:background .3s,box-shadow .3s}
    .btn:hover{background:#ff6666;box-shadow:0 0 25px #ff6666bb}
    .small{font-size:.95rem;color:#d1d9efcc;margin-top:1rem}
    #error{color:#ff9b9b;margin-top:.6rem;min-height:1.1em}
    #toast{position:fixed;left:50%;transform:translateX(-50%);bottom:20px;background:#222;color:#fff;padding:.6rem .9rem;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.5);opacity:0;transition:opacity .2s;z-index:99999;pointer-events:none}
    @media (max-width:480px){.card{padding:1.3rem}}
  </style>
</head>
<body>
  <div class="card" role="main" aria-labelledby="loginTitle">
    <h1 id="loginTitle">Log in</h1>
    <p class="subtitle">Sign in to access your account</p>

    <form id="loginForm" autocomplete="on">
      <div class="form-group">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" placeholder="you@example.com" required autocomplete="email">
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <input id="password" name="password" type="password" placeholder="••••••••" required autocomplete="current-password">
      </div>

      <div style="text-align:left;margin-top:.2rem;">
        <label style="font-weight:700;color:#ffdede;">
          <input id="remember" type="checkbox" name="remember" style="width:16px;height:16px;accent-color:#ff3b3b">
          <span style="margin-left:.5rem;font-weight:700;color:#d1d9efcc">Remember me</span>
        </label>
      </div>

      <div id="error" aria-live="polite"></div>

      <button class="btn" type="submit">Log in</button>

      <div class="small">
        Need an account? <a style="color:#ff3b3b;font-weight:700;text-decoration:none" href="signup.html">Create one</a>
      </div>
    </form>
  </div>

  <div id="toast"></div>

<script>
(function(){
  const form = document.getElementById('loginForm');
  const errorDiv = document.getElementById('error');
  const toast = document.getElementById('toast');

  function showToast(msg, ms=2500){
    toast.textContent = msg; toast.style.opacity='1';
    setTimeout(()=> toast.style.opacity='0', ms);
  }

  function hexFromBuffer(buf){ return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join(''); }

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    errorDiv.textContent = '';

    const email = form.email.value.trim().toLowerCase();
    const password = form.password.value || '';
    if (!email || !password){ errorDiv.textContent = 'Please enter email and password.'; return; }

    // load registered users from localStorage
    const raw = localStorage.getItem('registeredUsers') || '[]';
    const list = JSON.parse(raw);

    const user = list.find(u => u.email === email);
    if (!user){
      errorDiv.textContent = 'This email is not registered. Please sign up first.';
      return;
    }

    // hash entered password and compare to stored hash
    let enteredHash = '';
    try {
      const enc = new TextEncoder().encode(password);
      const digest = await crypto.subtle.digest('SHA-256', enc);
      enteredHash = hexFromBuffer(digest);
    } catch(err){
      console.warn('hash failed', err);
      enteredHash = btoa(password);
    }

    if (enteredHash !== user.passwordHash){
      errorDiv.textContent = 'Wrong password. Try again.';
      return;
    }

    // login success
    // optionally save session info
    localStorage.setItem('loggedInUser', JSON.stringify({ email: user.email, username: user.username }));
    showToast('Logged in — redirecting...', 900);

    // If "remember me" is checked, persist a flag (demo)
    if (document.getElementById('remember').checked){
      localStorage.setItem('rememberMe', '1');
    } else {
      localStorage.removeItem('rememberMe');
    }

    // redirect to dashboard (change as you need)
    setTimeout(()=> window.location.href = window.location.origin + '/index.html', 800);
  });
})();
</script>
</body>
</html>
